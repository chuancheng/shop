/*!
* jsUri
* https://github.com/derek-watson/jsUri
*
* Copyright 2013, Derek Watson
* Released under the MIT license.
*
* Includes parseUri regular expressions
* http://blog.stevenlevithan.com/archives/parseuri
* Copyright 2007, Steven Levithan
* Released under the MIT license.
*/

require.config({baseUrl:Y.jsBaseUrl,paths:{"jquery.lazyload":"lib/jquery.lazyload-1.8.4-min","jquery.touchswap":"lib/jquery.touchswap-1.6.3-min",juicer:"lib/juicer-0.6.5",cookie:"modules/util/cookie",prober:"modules/util/prober",dialog:"modules/widget/dialog/dialog",loginBox:"modules/yinyuetai/loginbox",ajax:"modules/util/ajax",ajaxform:"modules/util/ajaxform",uri:"lib/uri",pushstream:"lib/pushstream",store:"lib/store.min",alertify:"modules/widget/alertify",swfobject:"lib/swfobject-2.0-min",page:"modules/yinyuetai/page",drag:"modules/interaction/drag",scrollbar:"modules/widget/tinyscrollbar",pwdencrypt:"modules/yinyuetai/passwordencrypt",user:"modules/yinyuetai/user/user",impress:"modules/widget/impress",placeholder:"modules/widget/placeholder",fancard:"modules/yinyuetai/fan/fancard",smart:"modules/util/smart",fastclick:"lib/fastclick.0.6.11"},shim:{juicer:{exports:"juicer"},uri:{exports:"Uri"},pushstream:{exports:"PushStream"},swfobject:{exports:"swfobject"},impress:{exports:"impress"}}}),function(){function r(t,n){var r,i,s,o,u,a,f,l;s={},o=n?e:function(e){return e},u=t.split(/;\s/g);for(r=0,i=u.length;r<i;r++){l=u[r].match(/([^=]+)=/i);if(l instanceof Array)try{a=e(l[1]),f=o(u[r].substring(l[1].length+1))}catch(c){}else a=e(u[r]),f="";a&&(s[a]=f)}return s}function i(e){if(!e||!e.length)throw new TypeError("Cookie name must be a non-empty string")}var e,t,n={};e=decodeURIComponent,t=encodeURIComponent,n.get=function(e,t){var n,s,o;return i(e),t=t||{},o=t.raw||!1,s=t.converter||function(e){return e},n=r(document.cookie,!o),s(n[e])},n.set=function(e,n,r){var s,o,u,a,f;return i(e),r=r||{},s=r.expires,o=r.domain,u=r.path,r.raw||(n=t(String(n))),a=e+"="+n,f=s,typeof f=="number"&&(f=new Date,f.setDate(f.getDate()+s)),f instanceof Date&&(a+="; expires="+f.toUTCString()),o&&o.length&&(a+="; domain="+o),u&&u.length&&(a+="; path="+u),r.secure&&(a+="; secure"),document.cookie=a,a},n.remove=function(e,t){return t=t||{},t.expires=new Date(0),this.set(e,"",t)};var s=navigator.userAgent.toLowerCase(),o=/iphone/i.test(s),u=/android/i.test(s),a=location.href,f=location.search,l=location.pathname,c=f.indexOf("frompc")===-1;if(document.domain=="www.yinyuetai.com"&&l==="/"){if(u||o){var h=n.get("isReadWap");h||(n.set("isReadWap","yes",{domain:"yinyuetai.com",path:"/"}),location.href="http://spread.mobile.yinyuetai.com/pop.jsp")}}else if(l.indexOf("/video/")==0&&c){if(o||u)location.href=a.replace(/\/video\//,"/wap/video/")}else l.indexOf("/playlist/")==0&&c&&(o||u)&&(location.href=a.replace(/\/playlist\//,"/wap/playlist/"));Y.isLoadByPartner=function(){var e=!1;try{window.parent!=window.self&&(document.domain=="v.yinyuetai.com"?window.parent.Y&&window.parent.Y.jsBaseUrl&&(e=!0):e=!0)}catch(t){}return e}(),window.$config=window.$config||{}}(),define("common",function(){}),define("cookie",["require","exports","module"],function(e,t){function i(e,t){var r,i,s,o,u,a,f,l;s={},o=t?n:function(e){return e},u=e.split(/;\s/g);for(r=0,i=u.length;r<i;r++){l=u[r].match(/([^=]+)=/i);if(l instanceof Array)try{a=n(l[1]),f=o(u[r].substring(l[1].length+1))}catch(c){}else a=n(u[r]),f="";a&&(s[a]=f)}return s}function s(e){if(!e||!e.length)throw new TypeError("Cookie name must be a non-empty string")}var n,r;n=decodeURIComponent,r=encodeURIComponent,t.get=function(e,t){var n,r,o;return s(e),t=t||{},o=t.raw||!1,r=t.converter||function(e){return e},n=i(document.cookie,!o),r(n[e])},t.set=function(e,t,n){var i,o,u,a,f;return s(e),n=n||{},i=n.expires,o=n.domain,u=n.path,n.raw||(t=r(String(t))),a=e+"="+t,f=i,typeof f=="number"&&(f=new Date,f.setDate(f.getDate()+i)),f instanceof Date&&(a+="; expires="+f.toUTCString()),o&&o.length&&(a+="; domain="+o),u&&u.length&&(a+="; path="+u),n.secure&&(a+="; secure"),document.cookie=a,a},t.remove=function(e,t){return t=t||{},t.expires=new Date(0),this.set(e,"",t)}}),function(e){function n(e){return e&&(e=decodeURIComponent(e),e=e.replace(t.pluses," ")),e}function r(e){var n=t.uri_parser,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i=n.exec(e||""),s={};return r.forEach(function(e,t){s[e]=i[t]||""}),s}function i(e){var n,r,i,s,o,u,a=[];if(typeof e=="undefined"||e===null||e==="")return a;e.indexOf("?")===0&&(e=e.substring(1)),r=e.toString().split(t.query_separator);for(n=0;n<r.length;n++)i=r[n],s=i.indexOf("="),s!==0&&(o=decodeURIComponent(i.substring(0,s)),u=decodeURIComponent(i.substring(s+1)),a.push(s===-1?[i,null]:[o,u]));return a}function s(e){this.uriParts=r(e),this.queryPairs=i(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}var t={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0,r=this.length;n<r;++n)e.call(t||this,this[n],n,this)}),["protocol","userInfo","host","port","path","anchor"].forEach(function(e){s.prototype[e]=function(t){return typeof t!="undefined"&&(this.uriParts[e]=t),this.uriParts[e]}}),s.prototype.hasAuthorityPrefix=function(e){return typeof e!="undefined"&&(this.hasAuthorityPrefixUserPref=e),this.hasAuthorityPrefixUserPref===null?this.uriParts.source.indexOf("//")!==-1:this.hasAuthorityPrefixUserPref},s.prototype.query=function(e){var t="",n,r;typeof e!="undefined"&&(this.queryPairs=i(e));for(n=0;n<this.queryPairs.length;n++)r=this.queryPairs[n],t.length>0&&(t+="&"),r[1]===null?t+=r[0]:(t+=r[0],t+="=",r[1]&&(t+=encodeURIComponent(r[1])));return t.length>0?"?"+t:t},s.prototype.getQueryParamValue=function(e){var t,n;for(n=0;n<this.queryPairs.length;n++){t=this.queryPairs[n];if(e===t[0])return t[1]}},s.prototype.getQueryParamValues=function(e){var t=[],n,r;for(n=0;n<this.queryPairs.length;n++)r=this.queryPairs[n],e===r[0]&&t.push(r[1]);return t},s.prototype.deleteQueryParam=function(e,t){var r=[],i,s,o,u;for(i=0;i<this.queryPairs.length;i++)s=this.queryPairs[i],o=n(s[0])===n(e),u=s[1]===t,(arguments.length===1&&!o||arguments.length===2&&(!o||!u))&&r.push(s);return this.queryPairs=r,this},s.prototype.addQueryParam=function(e,t,n){return arguments.length===3&&n!==-1?(n=Math.min(n,this.queryPairs.length),this.queryPairs.splice(n,0,[e,t])):arguments.length>0&&this.queryPairs.push([e,t]),this},s.prototype.replaceQueryParam=function(e,t,r){var i=-1,s,o;if(arguments.length===3){for(s=0;s<this.queryPairs.length;s++){o=this.queryPairs[s];if(n(o[0])===n(e)&&decodeURIComponent(o[1])===n(r)){i=s;break}}this.deleteQueryParam(e,r).addQueryParam(e,t,i)}else{for(s=0;s<this.queryPairs.length;s++){o=this.queryPairs[s];if(n(o[0])===n(e)){i=s;break}}this.deleteQueryParam(e),this.addQueryParam(e,t,i)}return this},["protocol","hasAuthorityPrefix","userInfo","host","port","path","query","anchor"].forEach(function(e){var t="set"+e.charAt(0).toUpperCase()+e.slice(1);s.prototype[t]=function(t){return this[e](t),this}}),s.prototype.scheme=function(){var e="";return this.protocol()?(e+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(e+=":"),e+="//"):this.hasAuthorityPrefix()&&this.host()&&(e+="//"),e},s.prototype.origin=function(){var e=this.scheme();return e=="file://"?e+this.uriParts.authority:(this.userInfo()&&this.host()&&(e+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(e+="@")),this.host()&&(e+=this.host(),this.port()&&(e+=":"+this.port())),e)},s.prototype.addTrailingSlash=function(){var e=this.path()||"";return e.substr(-1)!=="/"&&this.path(e+"/"),this},s.prototype.toString=function(){var e,n=this.origin();return this.path()?(e=this.path(),!t.ends_with_slashes.test(n)&&!t.starts_with_slashes.test(e)?n+="/":(n&&n.replace(t.ends_with_slashes,"/"),e=e.replace(t.starts_with_slashes,"/")),n+=e):this.host()&&(this.query().toString()||this.anchor())&&(n+="/"),this.query().toString()&&(this.query().toString().indexOf("?")!==0&&(n+="?"),n+=this.query().toString()),this.anchor()&&(this.anchor().indexOf("#")!==0&&(n+="#"),n+=this.anchor()),n},s.prototype.clone=function(){return new s(this.toString())},typeof define=="function"&&define.amd?define("uri",[],function(){return s}):typeof module!="undefined"&&typeof module.exports!="undefined"?module.exports=s:e.Uri=s}(this),define("modules/yinyuetai/secret",["require","exports","module","cookie"],function(e,t,n){function o(e){return g(a(m(e),e.length*8))}function u(e){var t=o(e);return t=t.substring(8,24),y(t)}function a(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;var n=1732584193,r=-271733879,i=-1732584194,s=271733878;for(var o=0;o<e.length;o+=16){var u=n,a=r,f=i,v=s;n=l(n,r,i,s,e[o+0],7,-680876936),s=l(s,n,r,i,e[o+1],12,-389564586),i=l(i,s,n,r,e[o+2],17,606105819),r=l(r,i,s,n,e[o+3],22,-1044525330),n=l(n,r,i,s,e[o+4],7,-176418897),s=l(s,n,r,i,e[o+5],12,1200080426),i=l(i,s,n,r,e[o+6],17,-1473231341),r=l(r,i,s,n,e[o+7],22,-45705983),n=l(n,r,i,s,e[o+8],7,1770035416),s=l(s,n,r,i,e[o+9],12,-1958414417),i=l(i,s,n,r,e[o+10],17,-42063),r=l(r,i,s,n,e[o+11],22,-1990404162),n=l(n,r,i,s,e[o+12],7,1804603682),s=l(s,n,r,i,e[o+13],12,-40341101),i=l(i,s,n,r,e[o+14],17,-1502002290),r=l(r,i,s,n,e[o+15],22,1236535329),n=c(n,r,i,s,e[o+1],5,-165796510),s=c(s,n,r,i,e[o+6],9,-1069501632),i=c(i,s,n,r,e[o+11],14,643717713),r=c(r,i,s,n,e[o+0],20,-373897302),n=c(n,r,i,s,e[o+5],5,-701558691),s=c(s,n,r,i,e[o+10],9,38016083),i=c(i,s,n,r,e[o+15],14,-660478335),r=c(r,i,s,n,e[o+4],20,-405537848),n=c(n,r,i,s,e[o+9],5,568446438),s=c(s,n,r,i,e[o+14],9,-1019803690),i=c(i,s,n,r,e[o+3],14,-187363961),r=c(r,i,s,n,e[o+8],20,1163531501),n=c(n,r,i,s,e[o+13],5,-1444681467),s=c(s,n,r,i,e[o+2],9,-51403784),i=c(i,s,n,r,e[o+7],14,1735328473),r=c(r,i,s,n,e[o+12],20,-1926607734),n=h(n,r,i,s,e[o+5],4,-378558),s=h(s,n,r,i,e[o+8],11,-2022574463),i=h(i,s,n,r,e[o+11],16,1839030562),r=h(r,i,s,n,e[o+14],23,-35309556),n=h(n,r,i,s,e[o+1],4,-1530992060),s=h(s,n,r,i,e[o+4],11,1272893353),i=h(i,s,n,r,e[o+7],16,-155497632),r=h(r,i,s,n,e[o+10],23,-1094730640),n=h(n,r,i,s,e[o+13],4,681279174),s=h(s,n,r,i,e[o+0],11,-358537222),i=h(i,s,n,r,e[o+3],16,-722521979),r=h(r,i,s,n,e[o+6],23,76029189),n=h(n,r,i,s,e[o+9],4,-640364487),s=h(s,n,r,i,e[o+12],11,-421815835),i=h(i,s,n,r,e[o+15],16,530742520),r=h(r,i,s,n,e[o+2],23,-995338651),n=p(n,r,i,s,e[o+0],6,-198630844),s=p(s,n,r,i,e[o+7],10,1126891415),i=p(i,s,n,r,e[o+14],15,-1416354905),r=p(r,i,s,n,e[o+5],21,-57434055),n=p(n,r,i,s,e[o+12],6,1700485571),s=p(s,n,r,i,e[o+3],10,-1894986606),i=p(i,s,n,r,e[o+10],15,-1051523),r=p(r,i,s,n,e[o+1],21,-2054922799),n=p(n,r,i,s,e[o+8],6,1873313359),s=p(s,n,r,i,e[o+15],10,-30611744),i=p(i,s,n,r,e[o+6],15,-1560198380),r=p(r,i,s,n,e[o+13],21,1309151649),n=p(n,r,i,s,e[o+4],6,-145523070),s=p(s,n,r,i,e[o+11],10,-1120210379),i=p(i,s,n,r,e[o+2],15,718787259),r=p(r,i,s,n,e[o+9],21,-343485551),n=d(n,u),r=d(r,a),i=d(i,f),s=d(s,v)}return Array(n,r,i,s)}function f(e,t,n,r,i,s){return d(v(d(d(t,e),d(r,s)),i),n)}function l(e,t,n,r,i,s,o){return f(t&n|~t&r,e,t,i,s,o)}function c(e,t,n,r,i,s,o){return f(t&r|n&~r,e,t,i,s,o)}function h(e,t,n,r,i,s,o){return f(t^n^r,e,t,i,s,o)}function p(e,t,n,r,i,s,o){return f(n^(t|~r),e,t,i,s,o)}function d(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function v(e,t){return e<<t|e>>>32-t}function m(e){var t=Array(),n=(1<<r)-1;for(var i=0;i<e.length*r;i+=r)t[i>>5]|=(e.charCodeAt(i/r)&n)<<i%32;return t}function g(e){var t="0123456789abcdef",n="";for(var r=0;r<e.length*4;r++)n+=t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15);return n}function y(e){var t="";for(var n=e.length-1;n>=0;n--)t+=e.charAt(n);return t}function b(e,t){return t.length!=13?(alert("timesign error !!!"),""):o(o(e)+t.substring(5,11))}function w(e,t){return t.length!=13?(alert("timesign error !!!"),""):o(u(e)+t.substring(5,11))}var r,i,s;r=8,s=e("cookie"),t.des=function(e){var t,n,r,i;return t=""+(new Date).getTime(),n=y(t),e&&e.length!=0?(r=b(e,t),i=w(e,n)):(r=b(t,n),i=w(n,t)),s.set("p2",i,{domain:"yinyuetai.com",path:"/"}),{_t:t,_p1:r,_p2:i}}}),define("ajaxform",["require","uri","modules/yinyuetai/secret"],function(e){function i(){var e,t;e=this.$el,t=this.options,e.submit(function(n){n.preventDefault(),o(e,r[t.secretName].apply(window,t.secretParam())),$.ajax({type:"POST",url:e.attr("action"),data:e.serialize(),beforeSend:function(){return t.onRequest.call(e)?!0:!1},success:function(n){t.onComplete.call(e,n)}})})}function s(e){function l(e){e.preventDefault();if(n.onRequest.call(t)){if(f)return!1;f=!0,t.off("submit"),o(t,r[u].apply(window,a())),t.submit(),t.on("submit",l)}}var t,n,i,s,u,a,f;return t=this.$el,n=this.options,u=n.secretName,a=n.secretParam,$("<input />").attr({type:"hidden",name:"cross_post",value:"1"}).appendTo(t),i=$("<iframe name="+e+"/>").attr({id:e,src:"about:blank"}).css("display","none").appendTo(document.body),i.on("load",function(){f=!1;try{var r=$("#"+e)[0].contentWindow.document.body;s=r.innerText,s||(s=r.innerHTML),s&&n.onComplete.call(t,$.parseJSON(s))}catch(i){n.onComplete.call(t)}}),t.on("submit",l),i}function o(e,t){$.each(t,function(t,n){var r=e.find("[name="+t+"]");r.length===0?$("<input />").attr({type:"hidden",name:t,value:n}).appendTo(e):r.val(n)})}function u(e,n){return n=n||{},n.el=e,new t(n)}var t,n,r;return n=e("uri"),r=e("modules/yinyuetai/secret"),t=Backbone.View.extend({options:{secretName:"des",secretParam:function(){return[]},onRequest:function(){return!0},onComplete:function(e){}},initialize:function(e){var t,r;t=this.$el;if(t.attr("target")&&$(t.attr("target")).length!=0)return;(new n(t.attr("action"))).host()!==""||t.find("[type=file]").length!==0?(r="f"+(new Date).getTime(),t.attr("target",r),this.iframe=s.call(this,r)):i.call(this)}}),u}),define("ajax",["require","exports","module","uri","modules/yinyuetai/secret","ajaxform"],function(e,t,n){var r=e("uri"),i=e("modules/yinyuetai/secret"),s=[],o=function(e,t){return typeof e=="string"&&typeof t=="string"?e===t:typeof e=="object"&&typeof t=="object"?$.param(e)===$.param(t):!1},u=function(e){var t=(new r(e)).host();return t!==""&&t!==document.domain},a=function(e){var t=$('<form method="post"></form>').attr({action:e.url}).appendTo(document.body),n=e.data||"",r,i={};return typeof n=="string"?(r=n.split("&"),$.each(r,function(e,t){t=t.split("="),i[t[0]]=t[1]})):i=n,$.each(i,function(e,n){$('<input type="hidden"/>').attr({name:e,value:n}).appendTo(t)}),t},f=function(t){var n=e("ajaxform"),r=a(t);new n(r,{onComplete:function(e){$(r.attr("target")).remove(),r.remove(),t.success&&t.success(e),_.isFunction(t.complete)?t.complete(e):_.isArray(t.complete)&&_.each(t.complete,function(t){t(e)})}}),r.submit()},l=function(e){for(var t=0,n=s.length;t<n;t++){var r=s[t];if(e.url==r.url&&o(r.data,e.data))return!1}s.push(e);var i=e.type.toLowerCase();if(u(e.url)){if(i==="post")return f(e),!1;e.dataType="jsonp"}else if(i==="post"){var a=c(e.secretName,e.secretParam);a&&(e.data?typeof e.data=="string"?e.data+="&"+$.param(a):e.data=$.extend(e.data,a):e.data=a)}return e},c=function(e,t){return i[e]?i[e](t()):null};return{ajax:function(e){var t=[function(){s=_.without(s,e)}];e.complete&&(t=t.concat(e.complete)),e.complete=undefined,e=$.extend({timeout:1e4,jsonp:"callback",type:"get",secretName:"des",secretParam:function(){return[]},complete:t},e);var n=!0;e.beforeSend&&typeof e.beforeSend=="function"&&(n=e.beforeSend());if(n===!1)return;var r=l(e);if(r)return $.ajax(r)},get:function(e,t,n,r){var i={type:"GET"};return e&&(i.url=e),t&&(i.data=t),n&&(i.success=n),r&&(i.dataType=r),this.ajax(i)},getJSON:function(e,t,n){return this.get(e,t,n,"json")},post:function(e,t,n,r){var i={type:"POST"};return e&&(i.url=e),t&&(i.data=t),n&&(i.success=n),r&&(i.dataType=r),this.ajax(i)}}}),define("user",["require","exports","module","cookie","ajax"],function(e,t,n){function o(e){var t,n;t=String.fromCharCode(2),e=decodeURIComponent(e),n=e.split(t),a.set({userId:n[0]*1,userName:n[1]})}function u(e){s.getJSON(Y.domains.loginSite+"/login-info","",function(t){a.set(t),e&&e()})}var r,i,s;r=e("cookie"),s=e("ajax"),i=Backbone.Model.extend({defaults:{userName:"",userId:0},isLogined:function(){return parseInt(this.get("userId"))?!0:!1},onLogin:function(e){this.on("logined",e)},logined:function(e){this.isLogined()?e():this.on("logined",e)},login:function(t,n){var r=this;this.isLogined()?t():(this.on("login",t),e(["loginBox"],function(e){e.trigger("show"),e.once("hide",function(){r.off("login"),n&&n()})}))},emit:function(){var e,t;e=r.get("token"),t=r.get("u_inf"),e!=null&&(t!=null&&t.length>0?o(t):u())},getUserInfo:function(e,t){if(this.isLogined()){var n=this,r=function(){return typeof e=="function"?n.toJSON():n.get(e)};n.has("isEmailVerified")?t&&t(r()):u(function(){t&&t(r())})}},checkEmail:function(t){this.getUserInfo("isEmailVerified",function(n){if(!n){var r='<div style="padding: 20px 30px;"><p>鎮ㄥソ鍍忚繕娌℃湁杩涜閭楠岃瘉銆�</p><p>涓轰笉褰卞搷閮ㄥ垎鍔熻兘鐨勪娇鐢紝璇峰厛杩涜 <a href="'+Y.domains.homeSite+'/settings/bind" target="_blank" class="special f14">閭楠岃瘉</a></p>'+"</div>";e(["dialog"],function(e){new e(r,{title:"閭楠岃瘉",width:400,height:100,isAutoShow:!0})})}else t&&t()})}});var a=new i;return a.on("change:userId",function(){a.trigger("logined"),a.trigger("login")}),a.emit(),a}),define("modules/widget/dialog/mask",["require"],function(e){var t,n,r,i;return r=$(document),i=navigator.userAgent.indexOf("MSIE 6.0")!==-1,n={position:i?"absolute":"fixed",top:0,left:0,width:"100%",height:i?r.outerHeight(!0):"100%",display:"none","z-index":998,opacity:.2,"background-color":"black"},t=Backbone.View.extend({initialize:function(){this.element=$("<iframe/>").attr({frameborder:0,scrolling:"no"}).css(n).appendTo(document.body)},show:function(){this.element.fadeIn()},hide:function(){this.element.fadeOut()}}),new t}),define("dialog",["require","exports","module","modules/widget/dialog/mask"],function(e,t,n){function u(e,t){return t=t||{},t.el=e||"<b></b>",new r(t)}var r,i,s,o;return i=e("modules/widget/dialog/mask"),s='<a href="javascript:void(0);" class="ico_close J_close">鍏抽棴</a>',o='<h3 class="dialog_title J_title">{title}</h3>',r=Backbone.View.extend({options:{width:300,height:"",hasMark:!0,hasClose:!0,isRemoveAfterHide:!0,isAutoShow:!0,title:"",className:"",effect:"fade",onShow:function(){},onHide:function(){}},events:{"click .J_close":"_close"},initialize:function(){this._status=!1,this.$el=$('<div class="dialog"/>').append(this.$el.show()).addClass(this.options.className).appendTo(document.body),this._isShowTitle(),this._isShowClose(),this._adjustPosition(),this.on("show",function(){this._status=!0,this._toggle("show")}),this.on("hide",function(){this._status=!1,this._toggle("hide")}),this.on("show",this.options.onShow,this.$el),this.on("hide",this.options.onHide,this.$el),this.options.isAutoShow&&this.trigger("show")},_getStyle:function(e){var t,n;t=this.options.width,n=this.options.height,n&&this.options.title!=""&&(n+=30);var e={width:t,height:n,"margin-left":-(t/2),"margin-top":-(n/2)};return{width:t,height:n,"margin-left":-(t/2),"margin-top":-(n/2)}},_isShowTitle:function(){var e=this.options.title;e!=""&&(this.$title=$(o.replace("{title}",e)).prependTo(this.$el))},_isShowClose:function(){this.options.hasClose&&$(s).attr("hidefocus","true").appendTo(this.$el)},_close:function(){this.trigger("hide")},_toggle:function(e){var t,n;t=this.options.effect,n=this,e=="show"?t==="none"?this.$el.css("display","block"):t==="fade"&&this.$el.fadeIn():e=="hide"&&(t==="none"?this.$el.css("display","none"):t==="fade"&&this.$el.fadeOut(),this.options.isRemoveAfterHide&&setTimeout(function(){n.$el.remove()},2e3)),this._toggleMask(e)},_toggleMask:function(e){this.options.hasMark&&(e=="show"?i.show():e=="hide"&&i.hide())},_adjustPosition:function(){var e,t;typeof this.options.width=="number"&&(e=this.options.width,this.$el.css("width",e)),typeof this.options.height=="number"&&(t=this.options.height,this.options.title!=""&&(t+=30),this.$el.css("height",t)),t=t||this.$el.height(),e=e||this.$el.width(),this.$el.css({"margin-left":-(e/2),"margin-top":-(t/2)})},status:function(){return this._status?"show":"hide"},show:function(){return this.trigger("show"),this},hide:function(){return this.trigger("hide"),this},destroy:function(){this.$el.remove(),i.hide()},resize:function(e,t){return this.options.width=e,this.options.height=t,this._adjustPosition(),this},title:function(e){return this.$title&&this.$title.html(e),this}}),u}),define("pwdencrypt",[],function(){function e(e){var t=0,n=1,r="inputvec",i=1,s="yytcdn2b",o=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756),u=new Array(-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344),a=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584),f=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928),l=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080),c=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312),h=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154),p=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696);pc2bytes0=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964),pc2bytes1=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697),pc2bytes2=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272),pc2bytes3=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144),pc2bytes4=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256),pc2bytes5=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488),pc2bytes6=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746),pc2bytes7=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568),pc2bytes8=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578),pc2bytes9=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488),pc2bytes10=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800),pc2bytes11=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744),pc2bytes12=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128),pc2bytes13=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261);var d=s.length>8?3:1,v=new Array(32*d),m=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0),g,y,b=0,w=0,E;for(var S=0;S<d;S++){k=s.charCodeAt(b++)<<24|s.charCodeAt(b++)<<16|s.charCodeAt(b++)<<8|s.charCodeAt(b++),L=s.charCodeAt(b++)<<24|s.charCodeAt(b++)<<16|s.charCodeAt(b++)<<8|s.charCodeAt(b++),E=(k>>>4^L)&252645135,L^=E,k^=E<<4,E=(L>>>-16^k)&65535,k^=E,L^=E<<-16,E=(k>>>2^L)&858993459,L^=E,k^=E<<2,E=(L>>>-16^k)&65535,k^=E,L^=E<<-16,E=(k>>>1^L)&1431655765,L^=E,k^=E<<1,E=(L>>>8^k)&16711935,k^=E,L^=E<<8,E=(k>>>1^L)&1431655765,L^=E,k^=E<<1,E=k<<8|L>>>20&240,k=L<<24|L<<8&16711680|L>>>8&65280|L>>>24&240,L=E;for(var x=0;x<m.length;x++)m[x]?(k=k<<2|k>>>26,L=L<<2|L>>>26):(k=k<<1|k>>>27,L=L<<1|L>>>27),k&=-15,L&=-15,g=pc2bytes0[k>>>28]|pc2bytes1[k>>>24&15]|pc2bytes2[k>>>20&15]|pc2bytes3[k>>>16&15]|pc2bytes4[k>>>12&15]|pc2bytes5[k>>>8&15]|pc2bytes6[k>>>4&15],y=pc2bytes7[L>>>28]|pc2bytes8[L>>>24&15]|pc2bytes9[L>>>20&15]|pc2bytes10[L>>>16&15]|pc2bytes11[L>>>12&15]|pc2bytes12[L>>>8&15]|pc2bytes13[L>>>4&15],E=(y>>>16^g)&65535,v[w++]=g^E,v[w++]=y^E<<16}var b=0,x,S,E,T,N,C,k,L,A,O,M,_,D,P,H,B=e.length,j=0,d=v.length==32?3:9;d==3?A=n?new Array(0,32,2):new Array(30,-2,-2):A=n?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2),E=8-B%8,e+=String.fromCharCode(E,E,E,E,E,E,E,E),E==8&&(B+=8),result="",tempresult="";while(b<B){k=e.charCodeAt(b++)<<24|e.charCodeAt(b++)<<16|e.charCodeAt(b++)<<8|e.charCodeAt(b++),L=e.charCodeAt(b++)<<24|e.charCodeAt(b++)<<16|e.charCodeAt(b++)<<8|e.charCodeAt(b++),E=(k>>>4^L)&252645135,L^=E,k^=E<<4,E=(k>>>16^L)&65535,L^=E,k^=E<<16,E=(L>>>2^k)&858993459,k^=E,L^=E<<2,E=(L>>>8^k)&16711935,k^=E,L^=E<<8,E=(k>>>1^L)&1431655765,L^=E,k^=E<<1,k=k<<1|k>>>31,L=L<<1|L>>>31;for(S=0;S<d;S+=3){P=A[S+1],H=A[S+2];for(x=A[S];x!=P;x+=H)N=L^v[x],C=(L>>>4|L<<28)^v[x+1],E=k,k=L,L=E^(u[N>>>24&63]|f[N>>>16&63]|c[N>>>8&63]|p[N&63]|o[C>>>24&63]|a[C>>>16&63]|l[C>>>8&63]|h[C&63]);E=k,k=L,L=E}k=k>>>1|k<<31,L=L>>>1|L<<31,E=(k>>>1^L)&1431655765,L^=E,k^=E<<1,E=(L>>>8^k)&16711935,k^=E,L^=E<<8,E=(L>>>2^k)&858993459,k^=E,L^=E<<2,E=(k>>>16^L)&65535,L^=E,k^=E<<16,E=(k>>>4^L)&252645135,L^=E,k^=E<<4,tempresult+=String.fromCharCode(k>>>24,k>>>16&255,k>>>8&255,k&255,L>>>24,L>>>16&255,L>>>8&255,L&255),j+=8,j==512&&(result+=tempresult,tempresult="",j=0)}var F=result+tempresult,I="",q=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");for(var x=0;x<F.length;x++)I+=q[F.charCodeAt(x)>>4]+q[F.charCodeAt(x)&15];return I}return e}),define("loginBox",["require","exports","module","dialog","ajaxform","user","pwdencrypt"],function(e,t,n){function c(e){var t,n,r;t=e.find(".errorinfo"),n=e.find("[name=email]"),r=e.find(".pwd"),p(n),p(r),new s(e,{secretParam:function(){return[$.trim(n.val())+$.trim(r.val())]},onRequest:function(){return h(n,r,t)?(e.find("[name=encpsw]").length!=0?e.find("[name=encpsw]").val(a(r.val())):$("<input />").attr({type:"hidden",name:"encpsw",value:a(r.val())}).appendTo(e),!0):!1},onComplete:function(e){e.error?t.text(e.message).css("visibility","visible"):e.platFormRef?location.href="http://login.yinyuetai.com/platform":(u.set(e),o.trigger("hide"))}})}function h(e,t,n){var r,i;r=$.trim(e.val()),i=$.trim(t.val());if(r.length===0)return n.text("閭鎴栨墜鏈轰笉鑳戒负绌�").css("visibility","visible"),e.parent().addClass("emailerror"),!1;if(!f.test(r)){if(!l.test(r))return n.text("璇疯緭鍏ユ纭殑鐢靛瓙閭鎴栨墜鏈�").css("visibility","visible"),e.parent().addClass("emailerror"),!1;if(r.length!==11)return n.text("璇疯緭鍏ユ纭殑鐢靛瓙閭鎴栨墜鏈�").css("visibility","visible"),e.parent().addClass("emailerror"),!1}return i.length===0?(n.text("瀵嗙爜涓嶈兘涓虹┖").css("visibility","visible"),t.parent().addClass("error"),!1):i.length<4||i.length>20?(n.text("瀵嗙爜闀垮害蹇呴』澶т簬4涓斿皬浜�20").css("visibility","visible"),t.parent().addClass("error"),!1):!0}function p(e){e.attr("name")==="email"?(e.focus(function(){$(this).parent().addClass("emailfocus").removeClass("emailerror")}),e.blur(function(){$(this).parent().removeClass("emailfocus")})):(e.focus(function(){$(this).parent().addClass("focus").removeClass("error")}),e.blur(function(){$(this).parent().removeClass("focus")}))}var r,i,s,o,u,a,f=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,l=/^[+-]?[1-9][0-9]*(\.[0-9]+)?([eE][+-][1-9][0-9]*)?$|^[+-]?0?\.[0-9]+([eE][+-][1-9][0-9]*)?$/;return r=e("dialog"),s=e("ajaxform"),u=e("user"),a=e("pwdencrypt"),i=['<div class="loginbox">','<div class="external">','<p class="title">浣跨敤鍚堜綔璐﹀彿鐧诲綍<span>(鎺ㄨ崘)</span></p>',"<ul>","<li>",'<a href="<%=url%>/api/login/sina-auth" target="_blank" class="weibo" hidefocus>寰崥甯愬彿</a>',"</li>","<li>",'<a href="<%=url%>/api/login/qq-auth" target="_blank" class="qq" hidefocus>QQ甯愬彿</a>',"</li>","<li>",'<a href="<%=url%>/api/login/renren-auth" target="_blank" class="renren" hidefocus>浜轰汉璐﹀彿</a>',"</li>","<li>",'<a href="<%=url%>/api/login/baidu-auth" target="_blank" class="baidu" hidefocus>鐧惧害甯愬彿</a>',"</li>","</ul>",'<p class="text">蹇嵎鐧诲綍锛屾棤闇€娉ㄥ唽</p>','<p class="text">涓庝綘鐨勬湅鍙嬪垎浜綘鐨勭埍锛�</p>',"</div>",'<div class="site">','<p class="title">闊虫偊Tai璐﹀彿鐧诲綍</p>','<form action="https://login.yinyuetai.com/login-ajax" method="post">','<p class="errorinfo">閿欒淇℃伅鎻愮ず</p>','<div class="email focuss">','<input type="text" name="email" placeholder="鎮ㄧ殑閭鍦板潃鎴栫粦瀹氭墜鏈�"/>',"</div>",'<div class="password">','<input type="password" class="pwd" placeholder="璇疯緭鍏ュ瘑鐮�"/>',"</div>","<div>",'<p class="autologin"><input type="checkbox" id="autocheckbox" name="autologin" checked hidefocus/><label for="autocheckbox">涓嬫鑷姩鐧诲綍</label></p>','<a class="forgot" href="<%=url%>/forgot-password" target="_blank" hidefocus>蹇樿瀵嗙爜</a>',"</div>","<div>",'<input class="submit" type="submit" hidefocus/>','<p class="reg">杩樻病鏈夐煶鎮ai璐﹀彿锛�<a href="<%=url%>/register" target="_blank" hidefocus>绔嬪嵆娉ㄥ唽锛�</a></p>',"</div>","</form>","</div>","</div>"].join(""),o=new r(_.template(i,{url:"http://login.yinyuetai.com"}),{width:691,height:307,isRemoveAfterHide:!1,isAutoShow:!1}),o.on("show",function(){c(o.$el.find("form"))}),o.on("hide",function(){var e=o.$el.find("form");e.find(".errorinfo").css("visibility","hidden"),e.find("[name=email],[name=password]").parent().removeClass("emailerror").removeClass("error"),$(".J_pop_download").removeClass("v_button_curv")}),o}),define("prober",["require","exports","module"],function(e,t){function c(e,t,n){var r,i;for(r=0,i=e.length;r<i;r++)if(t.call(e,e[r],r)===!1)break}function h(e){var t,n,r,i,o,u,a,f;return s.test(e)?(u=!1,e.indexOf("trident/")!==-1&&(t=/\btrident\/([0-9.]+)/.exec(e),t&&t.length>=2&&(r=t[1],f=t[1].split("."),f[0]=parseInt(f[0],10)+4,o=f.join("."))),t=s.exec(e),i=t[1],a=t[1].split("."),"undefined"==typeof o&&(o=i),a[0]=parseInt(a[0],10)-4,n=a.join("."),"undefined"==typeof r&&(r=n),{browserVersion:o,browserMode:i,engineVersion:r,engineMode:n,compatible:r!==n}):null}function p(e,t,n){var i,s,u,a;typeof n=="undefined"&&(n=r),i=o.call(t)==="[object Function]"?t.call(null,n):t;if(!i)return null;s={name:e,version:"-1",codename:""},u=o.call(i);if(i===!0)return s;if(u==="[object String]"){if(n.indexOf(i)!==-1)return s}else{if(o.call(i)==="[object Object]")return i.hasOwnProperty("version")&&(s.version=i.version),s;if(i.exec){a=i.exec(n);if(a)return a.length>=2&&a[1]?s.version=a[1].replace(/_/g,"."):s.version="-1",s}}}function d(e,t,n){var r;r={name:"na",version:"-1"},c(t,function(t){var n;n=p(t[0],t[1],e);if(n)return r=n,!1}),n(r.name,r.version)}function v(e){var t,n;return t={},e=(e||"").toLowerCase(),d(e,u,function(e,n){var r;r=parseFloat(n),t.device={name:e,version:r,fullVersion:n},t.device[e]=r}),d(e,a,function(e,n){var r;r=parseFloat(n),t.os={name:e,version:r,fullVersion:n},t.os[e]=r}),n=h(e),d(e,f,function(e,r){var i,s;i=r,n&&(r=n.engineVersion||n.engineMode,i=n.engineMode),s=parseFloat(r),t.engine={name:e,version:s,fullVersion:r,mode:parseFloat(i),fullMode:i,compatible:n?n.compatible:!1},t.engine[e]=s}),d(e,l,function(e,r){var i,s;i=r,n&&(e==="ie"&&(r=n.browserVersion),i=n.browserMode),s=parseFloat(r),t.browser={name:e,version:s,fullVersion:r,mode:parseFloat(i),fullMode:i,compatible:n?n.compatible:!1},t.browser[e]=s}),t}var n,r,i,s,o,u,a,f,l;return n={},r=navigator.userAgent||"",i=window.external,s=/\b(?:msie|ie) ([0-9.]+)/,o=Object.prototype.toString,u=[["nokia",function(e){return e.indexOf("nokia ")!==-1?/\bnokia ([0-9]+)?/:/\bnokia[\d]/.test(e)?/\bnokia(\d+)/:"nokia"}],["wp",function(e){return e.indexOf("windows phone ")!==-1||e.indexOf("xblwp")!==-1||e.indexOf("zunewp")!==-1||e.indexOf("windows ce")!==-1}],["mi",function(e){return e.indexOf("mi-one plus")!==-1?{version:"1s"}:/\bmi ([0-9.as]+)/}],["playstation",function(e){return(e.indexOf("playstation")!==-1||e.indexOf("wii")!==-1)&&e.indexOf("windows")==-1}],["blackberry",function(e){return(e.indexOf("blackberry")!==-1||e.indexOf("playbook ")!==-1||e.indexOf("rim")!==-1||e.indexOf("tablet")!==-1||e.indexOf("bb10")!==-1)&&e.indexOf("windows")==-1}],["pc","windows"],["ipad","ipad"],["ipod","ipod"],["iphone","iphone"],["mac","macintosh"],["aliyun","aliyunos"],["meizu",/\bm([0-9]+)\b/],["nexus",/\bnexus ([0-9.]+)/],["android","android"]],a=[["wp",function(e){return e.indexOf("windows phone ")!==-1?/\bwindows phone (?:os )?([0-9.]+)/:e.indexOf("xblwp")!==-1?/\bxblwp([0-9.]+)/:e.indexOf("zunewp")!==-1?/\bzunewp([0-9.]+)/:"windows phone"}],["windows",/\bwindows nt ([0-9.]+)/],["macosx",/\bmac os x ([0-9._]+)/],["ios",/\bcpu(?: iphone)? os ([0-9._]+)/],["yunos",/\baliyunos ([0-9.]+)/],["android",/\bandroid[ -]([0-9.]+)/],["chromeos",/\bcros i686 ([0-9.]+)/],["linux","linux"],["windowsce",/\bwindows ce(?: ([0-9.]+))?/],["symbian",/\bsymbianos\/([0-9.]+)/],["blackberry","blackberry"]],f=[["trident",s],["webkit",/\bapplewebkit\/([0-9.+]+)/],["gecko",/\bgecko\/(\d+)/],["presto",/\bpresto\/([0-9.]+)/]],l=[["sg",/ se ([0-9.x]+)/],["mx",function(e){try{if(i&&(i.mxVersion||i.max_version))return{version:i.mxVersion||i.max_version}}catch(t){}return/\bmaxthon(?:[ \/]([0-9.]+))?/}],["qq",/\bqqbrowser\/([0-9.]+)/],["green","greenbrowser"],["tt",/\btencenttraveler ([0-9.]+)/],["lb",function(e){if(e.indexOf("lbbrowser")===-1)return!1;var t="-1";try{i&&i.LiebaoGetVersion&&(t=i.LiebaoGetVersion())}catch(n){}return{version:t}}],["tao",/\btaobrowser\/([0-9.]+)/],["fs",/\bcoolnovo\/([0-9.]+)/],["sy","saayaa"],["baidu",/\bbidubrowser[ \/]([0-9.x]+)/],["ie",s],["mi",/\bmiuibrowser\/([0-9.]+)/],["opera",function(e){var t=/\bopera.+version\/([0-9.ab]+)/,n=/\bopr\/([0-9.]+)/;return t.test(e)?t:n}],["chrome",/ (?:chrome|crios|crmo)\/([0-9.]+)/],["android",function(e){if(e.indexOf("android")===-1)return;return/\bversion\/([0-9.]+(?: beta)?)/}],["safari",/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//],["firefox",/\bfirefox\/([0-9.ab]+)/],["uc",function(e){return e.indexOf("ucbrowser")!==-1?/\bucbrowser\/([0-9.]+)/:/\bucweb([0-9.]+)/}]],n=v(navigator.userAgent),n.parse=v,n}),define("placeholder",["require","exports","module"],function(e,t,n){var r,i;i=function(e){function a(t){var n={},r=/^jQuery\d+$/;return e.each(t.attributes,function(e,t){t.specified&&!r.test(t.name)&&(n[t.name]=t.value)}),n}function f(t,n){var r=this,i=e(r);if(r.value==i.attr("placeholder")&&i.hasClass("placeholder"))if(i.data("placeholder-password")){i=i.hide().next().show().attr("id",i.removeAttr("id").data("placeholder-id"));if(t===!0)return i[0].value=n;i.focus()}else r.value="",i.removeClass("placeholder"),r==document.activeElement&&r.select()}function l(){var t,n=this,r=e(n),i=this.id;if(n.value==""){if(n.type=="password"){if(!r.data("placeholder-textinput")){try{t=r.clone().attr({type:"text"})}catch(s){t=e("<input>").attr(e.extend(a(this),{type:"text"}))}t.removeAttr("name").data({"placeholder-password":r,"placeholder-id":i}).bind("focus.placeholder",f),r.data({"placeholder-textinput":t,"placeholder-id":i}).before(t)}r=r.removeAttr("id").hide().prev().attr("id",i).show()}r.addClass("placeholder"),r[0].value=r.attr("placeholder")}else r.removeClass("placeholder")}var t="placeholder"in document.createElement("input"),n="placeholder"in document.createElement("textarea"),r={},i=e.valHooks,s=e.propHooks,o,u;return t&&n?(u=r.placeholder=function(){return this},u.input=u.textarea=!0):(u=r.placeholder=function(){var e=this;return e.filter((t?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":f,"blur.placeholder":l}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},u.input=t,u.textarea=n,o={get:function(t){var n=e(t),r=n.data("placeholder-password");return r?r[0].value:n.data("placeholder-enabled")&&n.hasClass("placeholder")?"":t.value},set:function(t,n){var r=e(t),i=r.data("placeholder-password");return i?i[0].value=n:r.data("placeholder-enabled")?(n==""?(t.value=n,t!=document.activeElement&&l.call(t)):r.hasClass("placeholder")?f.call(t,!0,n)||(t.value=n):t.value=n,r):t.value=n}},t||(i.input=o,s.value=o),n||(i.textarea=o,s.value=o),e(function(){e(document).delegate("form","submit.placeholder",function(){var t=e(".placeholder",this).each(f);setTimeout(function(){t.each(l)},10)})}),e(window).bind("beforeunload.placeholder",function(){e(".placeholder").each(function(){this.value=""})})),u}($),r=!i.input||!i.textarea?function(e){e||(e=$("input, textarea")),e&&i.call($(e))}:function(){},r(),r.clear=function(e){function t(e){e.each(function(e,t){t=$(t),t[0].value===t.attr("placeholder")&&t.hasClass("placeholder")&&(t[0].value="")})}e=$(e),e[0].tagName==="FORM"?t(e.find("input.placeholder, textarea.placeholder")):t(e)},n.exports=r}),function(){var e=function(){var t=[].slice.call(arguments);t.push(e.options),t[0].match(/^\s*#([\w:\-\.]+)\s*$/igm)&&t[0].replace(/^\s*#([\w:\-\.]+)\s*$/igm,function(e,n){var r=document,i=r&&r.getElementById(n);t[0]=i?i.value||i.innerHTML:e});if(arguments.length==1)return e.compile.apply(e,t);if(arguments.length>=2)return e.to_html.apply(e,t)},t={escapehash:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},escapereplace:function(e){return t.escapehash[e]},escaping:function(e){return typeof e!="string"?e:e.replace(/[&<>"]/igm,this.escapereplace)},detection:function(e){return typeof e=="undefined"?"":e}},n=function(e){if(typeof console!="undefined"){if(console.warn){console.warn(e);return}if(console.log){console.log(e);return}}throw e},r=function(e,t){e=e!==Object(e)?{}:e;if(e.__proto__)return e.__proto__=t,e;var n=function(){},r=Object.create?Object.create(t):new(n.prototype=t,n);for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);return r};e.__cache={},e.version="0.6.5-stable",e.settings={},e.tags={operationOpen:"{@",operationClose:"}",interpolateOpen:"{{",interpolateClose:"}}",noneencodeOpen:"{{{",noneencodeClose:"}}}",commentOpen:"\\{#",commentClose:"\\}"},e.options={cache:!0,strip:!0,errorhandling:!0,detection:!0,_method:r({__escapehtml:t,__throw:n,__juicer:e},{})},e.tagInit=function(){var t=e.tags.operationOpen+"each\\s*([^}]*?)\\s*as\\s*(\\w*?)\\s*(,\\s*\\w*?)?"+e.tags.operationClose,n=e.tags.operationOpen+"\\/each"+e.tags.operationClose,r=e.tags.operationOpen+"if\\s*([^}]*?)"+e.tags.operationClose,i=e.tags.operationOpen+"\\/if"+e.tags.operationClose,s=e.tags.operationOpen+"else"+e.tags.operationClose,o=e.tags.operationOpen+"else if\\s*([^}]*?)"+e.tags.operationClose,u=e.tags.interpolateOpen+"([\\s\\S]+?)"+e.tags.interpolateClose,a=e.tags.noneencodeOpen+"([\\s\\S]+?)"+e.tags.noneencodeClose,f=e.tags.commentOpen+"[^}]*?"+e.tags.commentClose,l=e.tags.operationOpen+"each\\s*(\\w*?)\\s*in\\s*range\\(([^}]+?)\\s*,\\s*([^}]+?)\\)"+e.tags.operationClose,c=e.tags.operationOpen+"include\\s*([^}]*?)\\s*,\\s*([^}]*?)"+e.tags.operationClose;e.settings.forstart=new RegExp(t,"igm"),e.settings.forend=new RegExp(n,"igm"),e.settings.ifstart=new RegExp(r,"igm"),e.settings.ifend=new RegExp(i,"igm"),e.settings.elsestart=new RegExp(s,"igm"),e.settings.elseifstart=new RegExp(o,"igm"),e.settings.interpolate=new RegExp(u,"igm"),e.settings.noneencode=new RegExp(a,"igm"),e.settings.inlinecomment=new RegExp(f,"igm"),e.settings.rangestart=new RegExp(l,"igm"),e.settings.include=new RegExp(c,"igm")},e.tagInit(),e.set=function(e,t){var n=this,r=function(e){return e.replace(/[\$\(\)\[\]\+\^\{\}\?\*\|\.]/igm,function(e){return"\\"+e})},i=function(e,t){var i=e.match(/^tag::(.*)$/i);if(i){n.tags[i[1]]=r(t),n.tagInit();return}n.options[e]=t};if(arguments.length===2){i(e,t);return}if(e===Object(e))for(var s in e)e.hasOwnProperty(s)&&i(s,e[s])},e.register=function(e,t){var n=this.options._method;return n.hasOwnProperty(e)?!1:n[e]=t},e.unregister=function(e){var t=this.options._method;if(t.hasOwnProperty(e))return delete t[e]},e.template=function(t){var n=this;this.options=t,this.__interpolate=function(e,t,n){var r=e.split("|"),i=r[0]||"",s;return r.length>1&&(e=r.shift(),s=r.shift().split(","),i="_method."+s.shift()+".call({}, "+[e].concat(s)+")"),"<%= "+(t?"_method.__escapehtml.escaping":"")+"("+(!n||n.detection!==!1?"_method.__escapehtml.detection":"")+"("+i+")"+")"+" %>"},this.__removeShell=function(t,r){var i=0;t=t.replace(e.settings.forstart,function(e,t,n,r){var n=n||"value",r=r&&r.substr(1),s="i"+i++;return"<% ~function() {for(var "+s+" in "+t+") {"+"if("+t+".hasOwnProperty("+s+")) {"+"var "+n+"="+t+"["+s+"];"+(r?"var "+r+"="+s+";":"")+" %>"}).replace(e.settings.forend,"<% }}}(); %>").replace(e.settings.ifstart,function(e,t){return"<% if("+t+") { %>"}).replace(e.settings.ifend,"<% } %>").replace(e.settings.elsestart,function(e){return"<% } else { %>"}).replace(e.settings.elseifstart,function(e,t){return"<% } else if("+t+") { %>"}).replace(e.settings.noneencode,function(e,t){return n.__interpolate(t,!1,r)}).replace(e.settings.interpolate,function(e,t){return n.__interpolate(t,!0,r)}).replace(e.settings.inlinecomment,"").replace(e.settings.rangestart,function(e,t,n,r){var s="j"+i++;return"<% ~function() {for(var "+s+"="+n+";"+s+"<"+r+";"+s+"++) {{"+"var "+t+"="+s+";"+" %>"}).replace(e.settings.include,function(e,t,n){return"<%= _method.__juicer("+t+", "+n+"); %>"});if(!r||r.errorhandling!==!1)t="<% try { %>"+t,t+='<% } catch(e) {_method.__throw("Juicer Render Exception: "+e.message);} %>';return t},this.__toNative=function(e,t){return this.__convert(e,!t||t.strip)},this.__lexicalAnalyze=function(t){var n=[],r=[],i="",s=["if","each","_","_method","console","break","case","catch","continue","debugger","default","delete","do","finally","for","function","in","instanceof","new","return","switch","this","throw","try","typeof","var","void","while","with","null","typeof","class","enum","export","extends","import","super","implements","interface","let","package","private","protected","public","static","yield","const","arguments","true","false","undefined","NaN"],o=function(e,t){if(Array.prototype.indexOf&&e.indexOf===Array.prototype.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},u=function(t,i){i=i.match(/\w+/igm)[0];if(o(n,i)===-1&&o(s,i)===-1&&o(r,i)===-1){if(typeof window!="undefined"&&typeof window[i]=="function"&&window[i].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i))return t;if(typeof global!="undefined"&&typeof global[i]=="function"&&global[i].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i))return t;if(typeof e.options._method[i]=="function"||e.options._method.hasOwnProperty(i))return r.push(i),t;n.push(i)}return t};t.replace(e.settings.forstart,u).replace(e.settings.interpolate,u).replace(e.settings.ifstart,u).replace(e.settings.elseifstart,u).replace(e.settings.include,u).replace(/[\+\-\*\/%!\?\|\^&~<>=,\(\)\[\]]\s*([A-Za-z_]+)/igm,u);for(var a=0;a<n.length;a++)i+="var "+n[a]+"=_."+n[a]+";";for(var a=0;a<r.length;a++)i+="var "+r[a]+"=_method."+r[a]+";";return"<% "+i+" %>"},this.__convert=function(e,t){var n=[].join("");return n+="",n+="var _=_||{};",n+="var _out='';_out+='",t!==!1?(n+=e.replace(/\\/g,"\\\\").replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<%=(.+?)%>/g,"';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='")+"';return _out;",n):(n+=e.replace(/\\/g,"\\\\").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t").replace(/[\n]/g,"\\n").replace(/'(?=[^%]*%>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<%=(.+?)%>/g,"';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='")+"';return _out.replace(/[\\r\\n]\\s+[\\r\\n]/g, '\\r\\n');",n)},this.parse=function(e,t){var i=this;if(!t||t.loose!==!1)e=this.__lexicalAnalyze(e)+e;return e=this.__removeShell(e,t),e=this.__toNative(e,t),this._render=new Function("_, _method",e),this.render=function(e,t){if(!t||t!==n.options._method)t=r(t,n.options._method);return i._render.call(this,e,t)},this}},e.compile=function(e,t){if(!t||t!==this.options)t=r(t,this.options);try{var i=this.__cache[e]?this.__cache[e]:(new this.template(this.options)).parse(e,t);if(!t||t.cache!==!1)this.__cache[e]=i;return i}catch(s){return n("Juicer Compile Exception: "+s.message),{render:function(){}}}},e.to_html=function(e,t,n){if(!n||n!==this.options)n=r(n,this.options);return this.compile(e,n).render(t,n._method)},typeof module!="undefined"&&module.exports?module.exports=e:this.juicer=e}(),define("juicer",function(e){return function(){var t,n;return t||e.juicer}}(this)),define("modules/widget/autocomplete",["require","ajax","juicer","prober"],function(e){function s(e){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}function o(){this.options.container.removeClass("autocompletehide"),this.options.container.html($("#autocompletenormalTpl").html()),this.iframeshim&&this.iframeshim.css({display:"block",width:"104%",height:(this.options.container.find("li").length-1)*33-4,left:-5})}function u(){var e=a().css({position:"absolute",top:"34px",display:"none"}).appendTo(this.$el.parents(".search"));return e}function a(){return $("<iframe />").attr({frameborder:0,scrolling:"no","class":"iframeshim"})}function f(e,n){return n=n||{},n.el=e,new t(n)}var t,n,r,i;return n=e("ajax"),r=e("juicer"),i=e("prober"),r.register("encodeURIComponent",encodeURIComponent),t=Backbone.View.extend({options:{source:"url",template:"",container:""},events:{keyup:"_keyup"},initialize:function(){var e=this;this._timer=0,this._index=-1,this._enter(),this.$el.on("focus",_.bind(this._keyup,this)),$(document.body).on("click",function(t){$(t.target).attr("name")!="keyword"&&setTimeout(function(){e.destroy()},200)}),this.iframeshim=u.call(this)},_keyup:function(e){var t,n;n=$.trim(this.$el.val()),n==""&&o.call(this);if(e.keyCode!=38&&e.keyCode!=40)return this._setData(n),!1;t=this.options.container.find("li"),e.keyCode==38&&this._up(t),e.keyCode==40&&this._down(t)},_up:function(e){this._index>-1&&this._index--,this._index==-1&&(this._index=e.length-1);if(e.eq(this._index).hasClass("dotted")||e.eq(this._index).hasClass("h39"))this._index-=1,this._index==-1&&(this._index=e.length-1);e.removeClass("active").eq(this._index).addClass("active")},_down:function(e){this._index++,this._index==e.length&&(this._index=0);if(e.eq(this._index).hasClass("dotted")||e.eq(this._index).hasClass("h39"))this._index+=1;e.removeClass("active").eq(this._index).addClass("active")},_enter:function(){var e,t,n,r;n=this.$el.parents("form"),r=$.proxy(function(o){o.preventDefault(),e=this.options.container.find("li"),e.hasClass("active")?(t=e.eq(this._index).find("a")[0],i.engine.webkit?s(t):t.click(),this._index=-1,this.destroy(),this.$el.blur()):(n.off(),this.destroy(),this.$el.val()==""?n.attr("action",this.$el.data("url")):n.attr("action","http://so.yinyuetai.com"),n.submit(),this.$el.blur(),n.on("submit",r))},this),n.on("submit",r)},_setData:function(e){clearTimeout(this._timer),this._timer=setTimeout($.proxy(function(){this._readDataForDB(e,this.render)},this),200)},_readDataForDB:function(e,t){n.getJSON(this.options.source,{q:e,type:"All",maxResults:2},$.proxy(t,this))},render:function(e){e.videos?(this.options.container.removeClass("autocompletehide"),this.options.container.html(r.to_html(this.options.template,e)),this.iframeshim&&this.iframeshim.css({display:"block",width:"104%",height:(this.options.container.find("li").length-1)*33-7,left:-5})):$.trim(this.$el.val())!=""?this.destroy():o.call(this)},destroy:function(){this.options.container.addClass("autocompletehide"),this.options.container.html(""),this.iframeshim&&this.iframeshim.css("display","none")}}),f}),function(e){function N(t){return t&&t.allowPageScroll===undefined&&(t.swipe!==undefined||t.swipeStatus!==undefined)&&(t.allowPageScroll=u),t.click!==undefined&&t.tap===undefined&&(t.tap=t.click),t||(t={}),t=e.extend({},e.fn.swipe.defaults,t),this.each(function(){var n=e(this),r=n.data(x);r||(r=new C(this,t),n.data(x,r))})}function C(T,N){function nt(t){if(jt())return;if(e(t.target).closest(N.excludedElements,X).length>0)return;var n=t.originalEvent?t.originalEvent:t,r,i=S?n.touches[0]:n;V=y,S?$=n.touches.length:t.preventDefault(),P=0,H=null,z=null,B=0,F=0,I=0,R=1,U=0,J=Ut(),W=Xt(),Ht();if(!S||$===N.fingers||N.fingers===m||gt()){It(0,i),K=en(),$==2&&(It(1,n.touches[1]),F=I=Jt(J[0].start,J[1].start));if(N.swipeStatus||N.pinchStatus)r=ft(n,V)}else r=!1;if(r===!1)return V=E,ft(n,V),r;Ft(!0)}function rt(e){var t=e.originalEvent?e.originalEvent:e;if(V===w||V===E||Bt())return;var n,r=S?t.touches[0]:t,i=qt(r);Q=en(),S&&($=t.touches.length),V=b,$==2&&(F==0?(It(1,t.touches[1]),F=I=Jt(J[0].start,J[1].start)):(qt(t.touches[1]),I=Jt(J[0].end,J[1].end),z=Qt(J[0].end,J[1].end)),R=Kt(F,I),U=Math.abs(F-I));if($===N.fingers||N.fingers===m||!S||gt()){H=Zt(i.start,i.end),vt(e,H),P=Gt(i.start,i.end),B=$t(),zt(H,P);if(N.swipeStatus||N.pinchStatus)n=ft(t,V);if(!N.triggerOnTouchEnd||N.triggerOnTouchLeave){var s=!0;if(N.triggerOnTouchLeave){var o=tn(this);s=nn(i.end,o)}!N.triggerOnTouchEnd&&s?V=at(b):N.triggerOnTouchLeave&&!s&&(V=at(w)),(V==E||V==w)&&ft(t,V)}}else V=E,ft(t,V);n===!1&&(V=E,ft(t,V))}function it(e){var t=e.originalEvent;if(S&&t.touches.length>0)return Pt(),!0;Bt()&&($=Y),e.preventDefault(),Q=en(),B=$t(),ht()?(V=E,ft(t,V)):N.triggerOnTouchEnd||N.triggerOnTouchEnd==0&&V===b?(V=w,ft(t,V)):!N.triggerOnTouchEnd&&Tt()?(V=w,lt(t,V,c)):V===b&&(V=E,ft(t,V)),Ft(!1)}function st(){$=0,Q=0,K=0,F=0,I=0,R=1,Ht(),Ft(!1)}function ot(e){var t=e.originalEvent;N.triggerOnTouchLeave&&(V=at(w),ft(t,V))}function ut(){X.unbind(L,nt),X.unbind(D,st),X.unbind(O,rt),X.unbind(M,it),_&&X.unbind(_,ot),Ft(!1)}function at(e){var t=e,n=dt(),r=ct(),i=ht();return!n||i?t=E:r&&e==b&&(!N.triggerOnTouchEnd||N.triggerOnTouchLeave)?t=w:!r&&e==w&&N.triggerOnTouchLeave&&(t=E),t}function ft(e,t){var n=undefined;return Et()||wt()?n=lt(e,t,f):(yt()||gt())&&n!==!1&&(n=lt(e,t,l)),_t()&&n!==!1?n=lt(e,t,h):Dt()&&n!==!1?n=lt(e,t,p):Mt()&&n!==!1&&(n=lt(e,t,c)),t===E&&st(e),t===w&&(S?e.touches.length==0&&st(e):st(e)),n}function lt(u,a,d){var v=undefined;if(d==f){X.trigger("swipeStatus",[a,H||null,P||0,B||0,$]);if(N.swipeStatus){v=N.swipeStatus.call(X,u,a,H||null,P||0,B||0,$);if(v===!1)return!1}if(a==w&&bt()){X.trigger("swipe",[H,P,B,$]);if(N.swipe){v=N.swipe.call(X,u,H,P,B,$);if(v===!1)return!1}switch(H){case t:X.trigger("swipeLeft",[H,P,B,$]),N.swipeLeft&&(v=N.swipeLeft.call(X,u,H,P,B,$));break;case n:X.trigger("swipeRight",[H,P,B,$]),N.swipeRight&&(v=N.swipeRight.call(X,u,H,P,B,$));break;case r:X.trigger("swipeUp",[H,P,B,$]),N.swipeUp&&(v=N.swipeUp.call(X,u,H,P,B,$));break;case i:X.trigger("swipeDown",[H,P,B,$]),N.swipeDown&&(v=N.swipeDown.call(X,u,H,P,B,$))}}}if(d==l){X.trigger("pinchStatus",[a,z||null,U||0,B||0,$,R]);if(N.pinchStatus){v=N.pinchStatus.call(X,u,a,z||null,U||0,B||0,$,R);if(v===!1)return!1}if(a==w&&mt())switch(z){case s:X.trigger("pinchIn",[z||null,U||0,B||0,$,R]),N.pinchIn&&(v=N.pinchIn.call(X,u,z||null,U||0,B||0,$,R));break;case o:X.trigger("pinchOut",[z||null,U||0,B||0,$,R]),N.pinchOut&&(v=N.pinchOut.call(X,u,z||null,U||0,B||0,$,R))}}if(d==c){if(a===E||a===w)clearTimeout(et),Nt()&&!Lt()?(Z=en(),et=setTimeout(e.proxy(function(){Z=null,X.trigger("tap",[u.target]),N.tap&&(v=N.tap.call(X,u,u.target))},this),N.doubleTapThreshold)):(Z=null,X.trigger("tap",[u.target]),N.tap&&(v=N.tap.call(X,u,u.target)))}else if(d==h){if(a===E||a===w)clearTimeout(et),Z=null,X.trigger("doubletap",[u.target]),N.doubleTap&&(v=N.doubleTap.call(X,u,u.target))}else d==p&&(a===E||a===w)&&(clearTimeout(et),Z=null,X.trigger("longtap",[u.target]),N.longTap&&(v=N.longTap.call(X,u,u.target)));return v}function ct(){var e=!0;return N.threshold!==null&&(e=P>=N.threshold),e}function ht(){var e=!1;return N.cancelThreshold!==null&&H!==null&&(e=Wt(H)-P>=N.cancelThreshold),e}function pt(){return N.pinchThreshold!==null?U>=N.pinchThreshold:!0}function dt(){var e;return N.maxTimeThreshold?B>=N.maxTimeThreshold?e=!1:e=!0:e=!0,e}function vt(e,s){if(N.allowPageScroll===u||gt())e.preventDefault();else{var o=N.allowPageScroll===a;switch(s){case t:(N.swipeLeft&&o||!o&&N.allowPageScroll!=d)&&e.preventDefault();break;case n:(N.swipeRight&&o||!o&&N.allowPageScroll!=d)&&e.preventDefault();break;case r:(N.swipeUp&&o||!o&&N.allowPageScroll!=v)&&e.preventDefault();break;case i:(N.swipeDown&&o||!o&&N.allowPageScroll!=v)&&e.preventDefault()}}}function mt(){var e=St(),t=xt(),n=pt();return e&&t&&n}function gt(){return!!(N.pinchStatus||N.pinchIn||N.pinchOut)}function yt(){return!!mt()&&!!gt()}function bt(){var e=dt(),t=ct(),n=St(),r=xt(),i=ht(),s=!i&&r&&n&&t&&e;return s}function wt(){return!!(N.swipe||N.swipeStatus||N.swipeLeft||N.swipeRight||N.swipeUp||N.swipeDown)}function Et(){return!!bt()&&!!wt()}function St(){return $===N.fingers||N.fingers===m||!S}function xt(){return J[0].end.x!==0}function Tt(){return!!N.tap}function Nt(){return!!N.doubleTap}function Ct(){return!!N.longTap}function kt(){if(Z==null)return!1;var e=en();return Nt()&&e-Z<=N.doubleTapThreshold}function Lt(){return kt()}function At(){return($===1||!S)&&(isNaN(P)||P===0)}function Ot(){return B>N.longTapThreshold&&P<g}function Mt(){return!!At()&&!!Tt()}function _t(){return!!kt()&&!!Nt()}function Dt(){return!!Ot()&&!!Ct()}function Pt(){G=en(),Y=event.touches.length+1}function Ht(){G=0,Y=0}function Bt(){var e=!1;if(G){var t=en()-G;t<=N.fingerReleaseThreshold&&(e=!0)}return e}function jt(){return X.data(x+"_intouch")===!0}function Ft(e){e===!0?(X.bind(O,rt),X.bind(M,it),_&&X.bind(_,ot)):(X.unbind(O,rt,!1),X.unbind(M,it,!1),_&&X.unbind(_,ot,!1)),X.data(x+"_intouch",e===!0)}function It(e,t){var n=t.identifier!==undefined?t.identifier:0;return J[e].identifier=n,J[e].start.x=J[e].end.x=t.pageX||t.clientX,J[e].start.y=J[e].end.y=t.pageY||t.clientY,J[e]}function qt(e){var t=e.identifier!==undefined?e.identifier:0,n=Rt(t);return n.end.x=e.pageX||e.clientX,n.end.y=e.pageY||e.clientY,n}function Rt(e){for(var t=0;t<J.length;t++)if(J[t].identifier==e)return J[t]}function Ut(){var e=[];for(var t=0;t<=5;t++)e.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return e}function zt(e,t){t=Math.max(t,Wt(e)),W[e].distance=t}function Wt(e){return W[e].distance}function Xt(){var e={};return e[t]=Vt(t),e[n]=Vt(n),e[r]=Vt(r),e[i]=Vt(i),e}function Vt(e){return{direction:e,distance:0}}function $t(){return Q-K}function Jt(e,t){var n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return Math.round(Math.sqrt(n*n+r*r))}function Kt(e,t){var n=t/e*1;return n.toFixed(2)}function Qt(){return R<1?o:s}function Gt(e,t){return Math.round(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}function Yt(e,t){var n=e.x-t.x,r=t.y-e.y,i=Math.atan2(r,n),s=Math.round(i*180/Math.PI);return s<0&&(s=360-Math.abs(s)),s}function Zt(e,s){var o=Yt(e,s);return o<=45&&o>=0?t:o<=360&&o>=315?t:o>=135&&o<=225?n:o>45&&o<135?i:r}function en(){var e=new Date;return e.getTime()}function tn(t){t=e(t);var n=t.offset(),r={left:n.left,right:n.left+t.outerWidth(),top:n.top,bottom:n.top+t.outerHeight()};return r}function nn(e,t){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom}var C=S||!N.fallbackToMouseEvents,L=C?"touchstart":"mousedown",O=C?"touchmove":"mousemove",M=C?"touchend":"mouseup",_=C?null:"mouseleave",D="touchcancel",P=0,H=null,B=0,F=0,I=0,R=1,U=0,z=0,W=null,X=e(T),V="start",$=0,J=null,K=0,Q=0,G=0,Y=0,Z=0,et=null;try{X.bind(L,nt),X.bind(D,st)}catch(tt){e.error("events not supported "+L+","+D+" on jQuery.swipe")}this.enable=function(){return X.bind(L,nt),X.bind(D,st),X},this.disable=function(){return ut(),X},this.destroy=function(){return ut(),X.data(x,null),X},this.option=function(t,n){if(N[t]!==undefined){if(n===undefined)return N[t];N[t]=n}else e.error("Option "+t+" does not exist on jQuery.swipe.options")}}var t="left",n="right",r="up",i="down",s="in",o="out",u="none",a="auto",f="swipe",l="pinch",c="tap",h="doubletap",p="longtap",d="horizontal",v="vertical",m="all",g=10,y="start",b="move",w="end",E="cancel",S="ontouchstart"in window,x="TouchSwipe",T={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"button, input, select, textarea, a, .noSwipe"};e.fn.swipe=function(t){var n=e(this),r=n.data(x);if(r&&typeof t=="string"){if(r[t])return r[t].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+t+" does not exist on jQuery.swipe")}else if(!r&&(typeof t=="object"||!t))return N.apply(this,arguments);return n},e.fn.swipe.defaults=T,e.fn.swipe.phases={PHASE_START:y,PHASE_MOVE:b,PHASE_END:w,PHASE_CANCEL:E},e.fn.swipe.directions={LEFT:t,RIGHT:n,UP:r,DOWN:i,IN:s,OUT:o},e.fn.swipe.pageScroll={NONE:u,HORIZONTAL:d,VERTICAL:v,AUTO:a},e.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:m}}(jQuery),define("jquery.touchswap",function(){}),define("modules/widget/slider",["require","exports","module","jquery.touchswap","juicer"],function(e,t,n){e("jquery.touchswap");var r=Backbone.View.extend({options:{effect:"fade",duration:7e3},events:{"click .J_toggle":"toggle","click .J_goto":"goto",mouseenter:"pause",mouseleave:"play"},initialize:function(e){$.extend(this.options,e);var t=this;this.render(e.data),this.current=0,this.show(this.current),this.$el.swipe({swipe:function(e,n,r,i,s){n=="right"?t.go("prev"):t.go("next")},excludedElements:[],fingers:"all"})},render:function(t){var n=e("juicer"),r;if(t)this.count=t.length,this.$el.html(n.to_html(this.tpl,{images:t}));else{var i=this.count=this.$el.find("li").length;if(this.count>1){var s=[];for(var o=0;o<i;o++)o==0?s.push('<a href="javascript:;" class="J_goto cur" data-index="'+o+'">鈼�</a>'):s.push('<a href="javascript:;" class="J_goto" data-index="'+o+'">鈼�</a>');r=this.$el.find(".J_nav"),r.html(s.join("")),this.$el.find(".J_toggle").show()}}r=r||this.$el.find(".J_nav"),r.css("margin-left",0-r.width()/2),this.$item=this.$el.find("li"),this.$pointer=r.find("a"),this.options.effect=="slide"&&this.slideInit()},tpl:["{@if images.length>0}",'<a href="javascript:;" class="index_focus_pre J_toggle" data-direction="prev" title="涓婁竴寮�">涓婁竴寮�</a>','<a href="javascript:;" class="index_focus_next J_toggle" data-direction="next" title="涓嬩竴寮�">涓嬩竴寮�</a>',"{@/if}","<ul>","{@each images as image}","<li>",'<a href="#" class="pic" title="">','<div class="index_focus_info J_focus_info">',"<h3>{{image.title}}</h3>",'<p class="text">{{{image.text}}}</p>',"</div>",'<img class="pic" src="{{image.src}}" width="1600" height="600" alt=""/>',"</a>","</li>","{@/each}","</ul>",'<div class="slide_nav J_nav">',"{@if images.length>0}","{@each images as image,index}",'<a href="javascript:;" class="J_goto" data-index="{{index}}"{@if index==0} class="cur"{@/if}>鈼�</a>',"{@/each}","{@/if}","</div>"].join(""),toggle:function(e){var t=$(e.currentTarget).data().direction;this.go(t)},go:function(e){if(e=="prev"){var t=this.current-1;t<0&&(t=this.count-1)}else{var t=this.current+1;t>=this.count&&(t=0)}this.show(t,e)},"goto":function(e){var t=$(e.currentTarget).data().index;this.current!=t&&this.show(t,this.current>t?"prev":"next")},auto:function(){if(this.count>1){var e=this;clearTimeout(this._t),this.isPause||(this._t=setTimeout(function(){e.go("next")},this.options.duration))}},show:function(e,t){var n=$(this.$item[this.current]),r=$(this.$item[e]);this.options.effect=="fade"?this.fade(n,r):this.options.effect=="slide"&&(t?this.slide(n,r,t):(r.show(),this.onShowNext(r))),$(this.$pointer[this.current]).removeClass("cur"),$(this.$pointer[e]).addClass("cur"),this.current=e},fade:function(e,t){var n=this;e.stop(!0,!0).fadeOut(600,function(){n.onHidePrev(e)}),t.stop(!0,!0).fadeIn(600,function(){n.onShowNext($(this))})},slide:function(e,t,n){var r=this,i=t.clone().show(),s;n=="next"?(e.after(i),s=-this.imgWidth):n=="prev"&&(e.before(i),this.$ul.css("margin-left",-this.imgWidth),s=0),this.$ul.stop(!0,!0).animate({"margin-left":s},600,function(){i.remove(),e.hide(),t.show(),r.$ul.css("margin-left",0),r.onHidePrev(e),r.onShowNext(t)})},slideInit:function(){this.$ul=this.$el.find("ul"),this.imgWidth=this.$item.width(),this.$ul.css("width",this.imgWidth*2)},onHidePrev:function(e){this.findInfo(e).hide(),this.findTitle(e).stop(!0,!0).hide(),this.findText(e).hide()},onShowNext:function(e){var t=this;this.findInfo(e).show(),this.findTitle(e).fadeIn().queue(function(){var n=$(this);t.findText(e).fadeIn(function(){n.dequeue()})}),this.auto()},findInfo:function(e){return e.find(".J_focus_info")},findTitle:function(e){return e.find("h3")},findDesc:function(e){return e.find("h4")},findText:function(e){return e.find(".text")},pause:function(){clearTimeout(this._t),this.isPause=!0},play:function(){this.isPause=!1,this.auto()}}),i=function(e,t){var n=t||{};return n.el=e,new r(n)};n.exports=i}),define("modules/yinyuetai/game",["require","juicer","ajax","modules/widget/slider"],function(e){var t=e("juicer"),n=e("ajax"),r=e("modules/widget/slider"),i=['<div class="small-icon">','<a class="prev-game-nav J_toggle" data-direction="prev" href="javascript:;" style="display:none"></a>','<a class="next-game-nav J_toggle" data-direction="next" href="javascript:;" style="display:none"></a>',"<ul>","{@each smalls as small}","<li>",'<a href="{{small.url}}" target="_blank"><img width="75" height="75" src="{{small.image}}" alt="{{small.image}}"></a>','<a href="{{small.url}}" target="_blank">{{small.title}}</a>',"</li>","{@/each}","</ul>","</div>",'<div class="big-icon">','<a class="hand-btn J_web_type" href="http://partner.yinyuetai.com/game/#web-games"></a>','<a class="page-btn J_page_type" href="http://partner.yinyuetai.com/game/#web-games/#mobile-games"></a>','<a href="{{big.url}}" target="_blank"><img width="225" height="116" src="{{big.bigImage}}" alt="{{big.title}}"></a>','<a href="{{big.url}}" target="_blank">{{big.title}}</a>',"</div>"].join(""),s=$("#J_topbar_game"),o=null;s.on("mouseenter",function(){if(o)return;n.getJSON("http://www.yinyuetai.com/nav/get",null,function(e){o=e,s.find(".top_game").html(t.to_html(i,{smalls:o.smalls,big:o.bigs[0]}))})});var u=$("#mobile-games"),a=$("#web-games");if(u.length>0){var f=u.offset().top-40+"px",a=a.offset().top-40+"px";s.on("click",".J_web_type",function(){$("html,body").animate({scrollTop:f},600)}),s.on("click",".J_page_type",function(){$("html,body").animate({scrollTop:a},600)})}}),define("modules/yinyuetai/topbar",["require","user","prober","placeholder","modules/widget/autocomplete","modules/yinyuetai/game"],function(e){function o(e,t,n){var r,i,s,o,u,a;r=0,i="",s=/[^\x00-\xff]/g,o="",u=e.replace(s,"**").length;for(a=0;a<u;a++){o=e.charAt(a).toString(),o.match(s)!=null?r+=2:r++;if(r>t)break;i+=o}return n&&u>t&&(i+="..."),i}function u(){var e=this.$el;a().css({width:"100%",height:"41px"}).insertAfter(e);var t=a().css({top:"41px",display:"none"}).appendTo(e.find(".content"));e.find(".hoverhandler").hover(function(){var e=$(this).find(".dropdownmenu");t.css({display:"block",width:e.data("width")||$(this).find("li").eq(0).width(),height:e.data("height")||$(this).find("li").length*33-4,left:e.offset().left||$(this).offset().left})},function(){t.css({display:"none"})})}function a(){return $("<iframe />").attr({frameborder:0,scrolling:"no","class":"iframeshim"})}var t,n,r,i,s;n=e("user"),r=e("prober"),s=e("placeholder"),i=e("modules/widget/autocomplete"),e("modules/yinyuetai/game"),t=Backbone.View.extend({initialize:function(){var e=this;$("body").on("click",".J_login",function(t){e._showLoginBox(t)}),n.isLogined()||this._notLoginHandler(),n.logined(function(){$(window).off("focus"),e._loginHandler(),e._searchReseize()}),this._menusHoverEffect(),this._searchInputFocusEffect(),this._searchReseize(),$(window).resize(function(){e._searchReseize()}),new i(e.$el.find("[name=keyword]"),{source:"http://so.yinyuetai.com/search/smart-search",container:e.$el.find(".autocomplete"),template:$("#autocompleteTpl").html()}),(location.href.indexOf("so.yinyuetai.com")!=-1||location.href.indexOf("i.yinyuetai.com/s")!=-1)&&e.$el.find("[name=keyword]").parents("form").attr("target",""),u.call(e)},_showLoginBox:function(t){t.preventDefault(),e(["loginBox"],function(e){e.status()=="hide"?e.trigger("show"):e.trigger("hide")})},_menusHoverEffect:function(){var e;r.browser.name=="ie"&&r.browser.version==6&&(e=this.$el.find(".hoverhandler"),e.mouseenter(function(){$(this).addClass("hover")}),e.mouseleave(function(){$(this).removeClass("hover")}))},_searchInputFocusEffect:function(){var e=this.$el.find(".search");e.find("input").focus(function(){e.addClass("focus")}),e.find("input").blur(function(){e.removeClass("focus")})},_searchReseize:function(){var e,t;e=this,t=_.throttle(function(){var t,r,i,s,o,u,a,f,l;t=e.$el.find(".content").width(),r=e.$el.find("h1").width(),s=e.$el.find(".userinfo").width(),o=e.$el.find(".login").width(),a=e.$el.find(".search"),f=a.find(".searchbody"),l=a.find("input"),e.$el.width()<1090?(e.$el.find(".content").css("padding","0 0 0 4px"),e.$el.find(".menus .border").css("margin","13px 0 0"),e.$el.find(".menus .link").css("padding","0 8px 0 8px")):(e.$el.find(".content").css("padding","0 20px"),e.$el.find(".menus .border").css("margin","13px 13px 0"),e.$el.find(".menus .link").css("padding","0 12px 0 13px")),i=e.$el.find(".menus").width(),n.isLogined()?u=i+r+s:u=i+r+o,u=t-u,u/2-a.width()/2<0?a.css("margin-right",7.5):a.css("margin-right",u/2-a.width()/2),u<223?(a.width(160),f.width(130),l.width(112)):(a.width(223),f.width(193),l.width(178)),a.removeClass("hide")},200),t()},_notLoginHandler:function(){var t,r;r=this,t=0,$(window).on("focus",function(){n.emit(),n.isLogined()&&t==0&&(t=1,e(["loginBox"],function(e){e.status()=="show"&&r.$el.find(".J_login").click()}))})},_loginHandler:function(){var t,r,i;t=this.$el.find(".userinfo"),r=this.$el.find(".decoration"),i=this.$el.find(".login"),t.find(".user span").text(o(n.get("userName"),10)).attr("title",n.get("userName")),r.attr("href",r.attr("href").replace("userId",n.get("userId"))),i.addClass("hide"),t.removeClass("hide"),$(function(){setTimeout(function(){e(["modules/yinyuetai/messenger"],function(){})},5e3)})}}),new t({el:$(".topbar")})}),define("modules/util/str",["require","exports","module"],function(e,t,n){n.exports={getLength:function(e){var t=0,n=e.length;while(n--)/^[\u0000-\u00ff]$/.test(e.charAt(n))?t+=1:t+=2;return t}}});